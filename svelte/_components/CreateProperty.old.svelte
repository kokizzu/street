<script>
  import { Icon } from '../node_modules/svelte-icons-pack/dist';
  import {
    FaSolidAngleLeft, FaSolidMap, FaSolidFlagUsa,
    FaSolidBed, FaSolidBath, FaSolidChair, FaSolidBorderTopLeft,
    FaClock, FaSolidCamera, FaSolidImage, FaSolidHouse,
    FaSolidCircleNotch, FaCircleCheck
  } from '../node_modules/svelte-icons-pack/dist/fa';
  import { RiFinanceExchangeLine } from '../node_modules/svelte-icons-pack/dist/ri';
  import { formatPrice}  from './formatter';
  import AddOtherFeesDialog from './AddOtherFeesDialog.svelte';
  import { RealtorUpsertProperty } from '../jsApi.GEN';
  import { onMount } from 'svelte';
  import { notifier } from './notifier.js';
  
  export let user;
  export let property;
  export let countries;
  
  let currentPage = 0, isPropertySubmitted = false;
  let cards = [{}, {}, {}, {}];
  let stackContainerElm, stacks, observer;
  
  let countryCurrency = 'TWD';
  const defaultLat = 23.6978, defaultLng = 120.9605;
  
  onMount( () => {
    stacks = document.querySelectorAll('#subpage_container .subpage');
    observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.intersectionRatio === 1) {
          const elementId = entry.target.id;
          const matchNum = elementId.match(/\d+/);
          if (matchNum) {
            currentPage = parseInt(matchNum[0]);
          }
        }
      })
    }, {
      root: stackContainerElm,
      rootMargin: '0px',
      threshold: 1.0,
    });

    console.log("User data = ", user)
    property = {
      countryCode: user.country,
      city: '',
      countyName: '',
      address: '',
      district: '',
      street: '',
      street2: '',
      floors: 1,
      formattedAddress: '',
      coord: [defaultLat, defaultLng],
      altitude: 0,
      uniqPropKey: '1_12449819078726277117',
      serialNumber: '',
      houseType: '',
      bedroom: 0,
      bathroom: 0,
      livingroom: 0, // new
      sizeM2: 0,
      purpose: 'sell',
      agencyFeePercent: 0,
      parking: '0', // new
      depositFee: 0, // new
      minimumDurationYear: 0, // new
      otherFee: [], // new
      lastPrice: 0,
      images: [],
      imageLabels: [],
      createdAt: 1692641835,
      updatedAt: 1692641835,
    };
    for( let i = 0; i<countries.length; i++ ) {
      if( countries[ i ].iso_2===property.countryCode ) {
        countryCurrency = countries[ i ].currency.code;
      }
    }
    console.log('property.countryCode=',property.countryCode)
  } );

  function subpageScroll() {
    stacks.forEach( stack => {
      observer.observe(stack);
    })
  }
  
  function GetPayload() {
    property.note = JSON.stringify(noteObj);
    if( property.countryCode==='US' ) property.city = property.countyName;
    return {
      countryCode: property.countryCode || user.country,
      city: property.city,
      countyName: property.countyName,
      district: property.district,
      street: property.street + "\n" + (property.street2 || ''),
      livingroom: property.livingroom,
      parking: parseFloat( property.parking ),
      depositFee: property.depositFee,
      minimumDurationYear: property.minimumDurationYear,
      otherFees: property.otherFees || [],
      imageLabels: property.imageLabels || [],
      altitude: property.altitude,
      id: property.id,
      formattedAddress: property.formattedAddress,
      coord: property.coord,
      houseType: property.houseType,
      purpose: property.purpose,
      images: property.images || [],
      bedroom: property.bedroom,
      bathroom: property.bathroom,
      sizeM2: '' + property.sizeM2,
      mainUse: property.mainUse,
      note: property.note,
      lastPrice: '' + property.lastPrice,
      agencyFeePercent: property.agencyFeePercent || 0,
    };
  }
  
  function progressDotHandler( toPage ) {
    currentPage = toPage;
    let card = cards[ toPage ];
    card.scrollIntoView( {behavior: 'smooth'} );
  }
  
  function nextPage() {
    if( currentPage<3 ) {
      currentPage++;
      let card = cards[ currentPage ];
      card.scrollIntoView( {behavior: 'smooth'} );
    }
  }
  
  function backPage() {
    if( currentPage>0 ) {
      currentPage--;
      let card = cards[ currentPage ];
      card.scrollIntoView( {behavior: 'smooth'} );
    }
  }
  
  // +=============| Location and Signage |=============+ //
  const LOC_ADDR = 'Address';
  const LOC_MAP = 'Put the pin on your house location by clicking the map';
  const LOC_STREETVIEW = 'Please input the height of your floor';
  let modeLocationCount = 0, countryName = 'Country';
  const modeLocationLists = [
    {mode: LOC_ADDR},
    {mode: LOC_MAP},
    {mode: LOC_STREETVIEW},
  ];
  let modeLocation = modeLocationLists[ modeLocationCount ].mode;
  let map, map_container, input_address, input_address_value;

  let noteObj = {
    contactPhone: "",
    contactEmail: "",
    about: ""
  }
  
  async function initMap() {
    const {Map} = await google.maps.importLibrary( 'maps' );
    const geocoder = new google.maps.Geocoder();
    map = new Map( map_container, {
      center: {
        lat: property.coord[ 0 ],
        lng: property.coord[ 1 ],
      },
      zoom: 8,
      mapTypeId: 'roadmap',
      mapId: 'street_project',
    } );
    const {SearchBox} = await google.maps.importLibrary( 'places' );
    let searchBox = new SearchBox( input_address );
    map.controls[ google.maps.ControlPosition.TOP_LEFT ].push( input_address );
    let markers = [];
    
    await geocoder.geocode( {address: input_address_value} )
      .then( ( {results} ) => {
        if( results[ 0 ] ) {
          console.log( 'Result = ', results )
          property.coord[ 0 ] = results[ 0 ].geometry.location.lat();
          property.coord[ 1 ] = results[ 0 ].geometry.location.lng();
          property.formattedAddress = results[ 0 ].formatted_address;
          for( let i = 0; i<results[ 0 ].address_components.length; i++ ) {
            if( results[ 0 ].address_components[ i ].types.indexOf( 'country' )!== -1 ) {
              property.countryCode = results[ 0 ].address_components[ i ].short_name;
              countryName = results[ 0 ].address_components[ i ].long_name;
            }
          }
          map.setCenter( results[ 0 ].geometry.location );
        } else {
          input_address_value = '';
        }
      } ).catch( ( e ) => {
        input_address_value = '';
        notifier.showError('cannot get address');
      } );
    
    const markerEventHandler = ( event ) => {
      property.coord[ 0 ] = event.latLng.lat();
      property.coord[ 1 ] = event.latLng.lng();
      getAddress( event.latLng );
    };
    const createMarker = ( map, latLng ) => {
      let marker = new google.maps.Marker( {
        map,
        position: latLng,
        draggable: true,
      } );
      marker.listenerHandle = google.maps.event.addListener( marker, 'dragend', markerEventHandler );
      return marker;
    };
    const clearMarkers = ( markers ) => {
      markers.forEach( ( marker ) => {
        marker.setMap( null );
        if( marker.listenerHandle && 'function'=== typeof marker.listenerHandle.remove ) marker.listenerHandle.remove();
      } );
      markers.length = 0;
    };
    markers.push( createMarker( map, {
      lat: property.coord[ 0 ],
      lng: property.coord[ 1 ],
    } ) );
    
    const getAddress = ( latLng ) => {
      geocoder.geocode( {location: latLng}, ( results, status ) => {
        if( status===google.maps.GeocoderStatus.OK && results.length>0 ) {
          property.formattedAddress = results[ 0 ].formatted_address;
          for( let i = 0; i<results[ 0 ].address_components.length; i++ ) {
            if( results[ 0 ].address_components[ i ].types.indexOf( 'country' )!== -1 ) {
              property.countryCode = results[ 0 ].address_components[ i ].short_name;
              countryName = results[ 0 ].address_components[ i ].long_name;
            }
          }
        } else {
          notifier.showError( 'Address not found' );
          property.formattedAddresss = '';
          property.country = '';
        }
      } );
    };
    map.addListener( 'click', ( event ) => {
      clearMarkers( markers );
      const latLong = event.latLng;
      markers.push( createMarker( map, latLong ) );
      // Update data structure
      property.coord[ 0 ] = latLong.lat();
      property.coord[ 1 ] = latLong.lng();
      getAddress( latLong );
      // Callback for dragend event
    } );
    // Searchable map
    map.addListener( 'bounds_changed', () => {
      searchBox.setBounds( map.getBounds() );
    } );
    searchBox.addListener( 'places_changed', () => {
      const places = searchBox.getPlaces();
      if( places.length===0 ) {
        return;
      }
      // Fill formatted_address, latitude, and longitude as JSON values
      property.coord[ 0 ] = places[ 0 ].geometry.location.lat();
      property.coord[ 1 ] = places[ 0 ].geometry.location.lng();
      property.formattedAddress = places[ 0 ].formatted_address;
      for( let i = 0; i<places[ 0 ].address_components.length; i++ ) {
        if( places[ 0 ].address_components[ i ].types.indexOf( 'country' )!== -1 ) {
          countryName = places[ 0 ].address_components[ i ].long_name;
        }
      }
      // Clear out the old markers
      clearMarkers( markers );
      // For each place, get the icon, name and location.
      const bounds = new google.maps.LatLngBounds();
      places.forEach( ( place ) => {
        if( !place.geometry || !place.geometry.location ) {
          notifier.showError( 'Returned place contains no geometry' );
          return;
        }
        // create marker for each place
        markers.push( createMarker( map, place.geometry.location ) );
        if( place.geometry.viewport ) {
          // Only geocodes have viewport
          bounds.union( place.geometry.viewport );
        } else {
          bounds.extend( place.geometry.location );
        }
      } );
      map.fitBounds( bounds );
    } );
  }
  
  function changeCurrency() {
    countries.forEach( ( c ) => {
      if( c.iso_2===property.country ) {
        countryCurrency = c.currency.code;
      }
    } );
  }
  
  async function handleBackLocation() {
    if( modeLocationCount<modeLocationLists.length ) {
      modeLocationCount -= 1;
      modeLocation = modeLocationLists[ modeLocationCount ].mode;
      if( modeLocation===LOC_MAP ) {
        await initMap();
      }
    }
  }
  
  const handleNextLocation = {
    'LOC_ADDR': async () => {
      if( property.city==='' || property.street==='' ) {
        notifier.showError( 'Please fill required form' );
        return;
      }
      for( let i = 0; i<countries.length; i++ ) {
        if( countries[ i ].iso_2===property.countryCode ) {
          countryName = countries[ i ].country;
          countryCurrency = countries[ i ].currency.code;
          property.lat = parseInt( countries[ i ].coordinate.lat );
          property.lng = parseInt( countries[ i ].coordinate.lng );
        }
      }
      input_address_value = property.street;
      modeLocationCount += 1;
      modeLocation = modeLocationLists[ modeLocationCount ].mode;
      await initMap();
    },
    'LOC_MAP': () => {
      if( property.formattedAddress==='' ) {
        notifier.showError('Please mark location on map' );
        return;
      }
      modeLocationCount += 1;
      modeLocation = modeLocationLists[ modeLocationCount ].mode;
    },
    'LOC_STREETVIEW': () => {
      nextPage();
    },
  };
  
  // +================| Info |=================+ //
  const INFO_FEAT = 'Feature', INFO_PRICE = 'Price';
  const m2 = 'M2', ping = 'Ping';
  let modeInfoCount = 0, infoUnitMode = m2, houseSize = parseInt( property.sizeM2 ), houseSizeM2 = 0, houseSizePing = 0;
  const modeInfoLists = [
    {mode: INFO_FEAT},
    {mode: INFO_PRICE},
  ];
  let modeInfo = modeInfoLists[ modeInfoCount ].mode;
  let infoObj = {
    agencyFee: 'false',
    deposit: 'false',
    houseType: property.houseType,
  };
  let otherFeeObj = {
    name: '',
    fee: 0,
  };
  let addOtherFeeDialog = AddOtherFeesDialog;
  let houseTypeLists = [
    'house', 'land', 'apartment', 'townhouse', 'condo', 'villa', 'factory', 'parking', 'other',
  ];
  
  function addOtherFee() {
    property.otherFee = [...property.otherFee, otherFeeObj];
    otherFeeObj = {
      name: '',
      fee: 0,
    };
    addOtherFeeDialog.hideModal();
  }
  
  const handleInfoUnitMode = {
    'toggle': () => {
      if( infoUnitMode===ping ) {
        if( houseSize!==0 ) {
          houseSizePing = houseSize;
          houseSizeM2 = handleInfoUnitMode.pingToM2( houseSize );
          infoUnitMode = m2;
          houseSize = houseSizeM2;
        } else {
          infoUnitMode = m2;
        }
      } else if( infoUnitMode===m2 ) {
        if( houseSize!==0 ) {
          houseSizeM2 = houseSize;
          houseSizePing = handleInfoUnitMode.m2ToPing( houseSize );
          infoUnitMode = ping;
          houseSize = houseSizePing;
        } else {
          infoUnitMode = ping;
        }
      }
    },
    'm2ToPing': ( m2 ) => {
      const value = m2 / 3.30579;
      const minifiedValue = value.toFixed( 2 );
      return parseFloat( minifiedValue );
    },
    'pingToM2': ( ping ) => {
      const value = ping * 3.30579;
      const minifiedValue = value.toFixed( 2 );
      return parseFloat( minifiedValue );
    },
  };
  
  function handleBackInfo() {
    if( modeInfoCount>0 ) {
      modeInfoCount -= 1;
      modeInfo = modeInfoLists[ modeInfoCount ].mode;
      return;
    }
    backPage();
  }
  
  const handleNextInfo = {
    'INFO_FEAT': () => {
      property.parking = infoObj.parking;
      property.houseType = infoObj.houseType;
      if( infoUnitMode===ping ) {
        property.sizeM2 = handleInfoUnitMode.pingToM2( houseSize );
      }
      if( infoUnitMode===m2 ) {
        property.sizeM2 = houseSize;
      }
      if( property.sizeM2===0 ) {
        notifier.showError( 'Please fill required form' );
        return;
      }
      modeInfoCount += 1;
      modeInfo = modeInfoLists[ modeInfoCount ].mode;
    },
    'INFO_PRICE': () => {
      if( property.lastPrice===0 || property.agencyFee>=99 ) {
        notifier.showWarning( 'Price cannot be 0' );
        return;
      }
      nextPage();
    },
  };
  
  // +================| Picture |=================+ //
  let imageHouseInput;
  let houseImgUploading = false;
  let uploadHouseStatus = '';
  let uploadHousePercent = 0;
  
  function handlerHouseImage() {
    if( !imageHouseInput ) return;
    const file = imageHouseInput.files[ 0 ];
    if( file ) {
      let formData = new FormData();
      formData.append( 'rawFile', file );
      formData.append( 'purpose', 'property' ); // property or floorPlan
      let ajax = new XMLHttpRequest();
      ajax.addEventListener( 'progress', function( event ) {
        houseImgUploading = true;
        let percent = (event.loaded / event.total) * 100;
        uploadHousePercent = Math.round( percent );
        uploadHouseStatus = `${uploadHousePercent}% uploaded... please wait`;
      } );
      ajax.addEventListener( 'load', function( event ) {
        houseImgUploading = false;
        if( ajax.status===200 ) {
          const out = JSON.parse( event.target.responseText );
          if( !out.error ) {
            property.images = [...property.images, out.urlPattern]; // push house image url to array
            property.imageLabels = [...property.imageLabels, ''];
          }
          notifier.showSuccess( 'Image uploaded' );
        } else if( ajax.status===413 ) {
          notifier.showError( 'Image too large' );
        } else {
          notifier.showError( `Error: ${ajax.status}  ${ajax.statusText}` );
        }
      } );
      ajax.addEventListener( 'error', function( event ) {
        notifier.showError( 'Network error' );
      } );
      ajax.addEventListener( 'abort', function( event ) {
        notifier.showWarning( 'Upload aborted' );
      }, false );
      ajax.open( 'POST', '/user/uploadFile' );
      ajax.send( formData );
    }
    imageHouseInput.value = null;
  }
  
  function removeImage( index ) {
    property.images = property.images.filter( ( _, i ) => i!==index );
    property.imageLabels = property.imageLabels.filter( ( _, i ) => i!==index );
    notifier.showSuccess( 'Image removed' );
  }
  
  // SUBMIT =====================+
  let res_propId = '1';
  let submitLoading = false;
  
  async function handleSubmit() {
    submitLoading = true;
    let payload = GetPayload();
    const prop = {property: payload};
    await RealtorUpsertProperty( prop, function( res ) {
      if( res.error ) {
        submitLoading = false;
        notifier.showError(res.error );
        return;
      }
      submitLoading = false;
      isPropertySubmitted = true;
      // after save, should retrieve the ID, so it became update mode, not creating new property
      property.id = (res.property || {}).id + '';
      res_propId = (res.property || {}).id + '';
      notifier.showSuccess( 'Property created' );
    } );
  }
</script>

<div class='realtor_step_progress_bar'>
	<div class='container'>
		<a class='back_button' href='/realtor'>
			<Icon className='iconBack' color='#475569' size={18} src={FaSolidAngleLeft}/>
		</a>
		<div class='step_wrapper'>
			<div class={currentPage >= 0 ? 'step_item completed' : 'step_item active'}>
				<button on:click={() => progressDotHandler(0)}></button>
				<p>Location</p>
			</div>
			<div class={currentPage === 1 ? 'step_item active' : 'step_item' && currentPage > 1 ? 'step_item completed' : 'step_item'}>
				<button on:click={() => progressDotHandler(1)}></button>
				<p>Info</p>
			</div>
			<div class={currentPage === 2 ? 'step_item active' : 'step_item' && currentPage > 2 ? 'step_item completed' : 'step_item'}>
				<button on:click={() => progressDotHandler(2)}></button>
				<p>Picture</p>
			</div>
			<div class={currentPage === 3 ? 'step_item active' : 'step_item'}>
				<button on:click={() => progressDotHandler(3)}></button>
				<p>Preview</p>
			</div>
		</div>
	</div>
</div>
<div class="create_property_container">
	<div class='content'>
		<div class='realtor_subpage_container' on:scroll={subpageScroll} id='subpage_container' bind:this={stackContainerElm}>
			<section bind:this={cards[0]} class='subpage location' id='subpage_1'>
				{#if modeLocation!==LOC_ADDR}
					<button
						class='back_button'
						on:click={() => {
                        if (currentPage === 0) {
                        handleBackLocation();
                     } else {
                        backPage()
                     }
						}}>
						<Icon className='iconBack' color='#475569' size={18} src={FaSolidAngleLeft}/>
					</button>
				{/if}
				<div class='subpage_content'>
					<h3>{ modeLocation }</h3>
					{#if modeLocation===LOC_ADDR}
						<div class='address'>
							<div class='row'>
								<div class='input_box'>
									<label for='country'>Country or Region <span class='asterisk'>*</span></label>
									<select id='country' name='country' bind:value={property.countryCode} on:change={changeCurrency}>
										{#each countries as country}
											<option value={country.iso_2}>{country.iso_2} {country.country}</option>
										{/each}
									</select>
								</div>
								<div class='input_box'>
									<label for='city_county'>City or County <span class='asterisk'>*</span></label>
									<input id='city_county' type='text' placeholder='Required' bind:value={property.city}/>
								</div>
							</div>
							<div class='row'>
								<div class='input_box'>
									<label for='street1'>Street 1 <span class='asterisk'>*</span></label>
									<input id='street1' type='text' placeholder='Required' bind:value={property.street}/>
								</div>
								<div class='input_box'>
									<label for='street2'>Street 2</label>
									<input id='street2' type='text' placeholder='Optional' bind:value={property.street2}/>
								</div>
							</div>
							<div class='row'>
								<div class='input_box'>
									<label for='floors'>Floors</label>
									<input id='floors' type='number' placeholder='10' min='0' bind:value={property.floors}/>
								</div>
                <div class='input_box'>
									<label for='contact'>Seller/Broker Email</label>
									<input id='contact' type='text' placeholder='johndoe@example.com' bind:value={noteObj.contactEmail}/>
								</div>
                <div class='input_box'>
									<label for='contact'>Seller/Broker Cellphone</label>
									<input id='contact' type='number' placeholder='+1 (555) 555-5555' bind:value={noteObj.contactPhone}/>
								</div>
							</div>
						</div>
					{/if}
					{#if modeLocation===LOC_MAP}
						<div class='location_map'>
							<div class='input_box'>
								<label for='input_address'></label>
								<input bind:this={input_address} bind:value={input_address_value} id='input_address' type='text'/>
							</div>
							<div class='address_country_info'>
								<div class='address'>
									<Icon color='#f97316' size={18} src={FaSolidMap}/>
									<p>{property.formattedAddress || 'Address'}</p>
								</div>
								<div class='country'>
									<Icon color='#f97316' size={15} src={FaSolidFlagUsa}/>
									<p>{countryName}</p>
								</div>
							</div>
							<div bind:this={map_container} class='map_container'>
								<!-- Map goes here, rendered automatically -->
							</div>
						</div>
					{/if}
					{#if modeLocation===LOC_STREETVIEW}
						<div class='location_streetview'>
							<p class='description'>Let buyers find your house on camera.</p>
							<div class='streetview_container'>
								<div class='input_box'>
									<label for='altitude'>Estimated distance (meter) from floor where you want to put your signage</label>
									<input id='altitude' type='number' min='0' step='0.1' placeholder='Required' bind:value={property.altitude}/>
								</div>
							</div>
<!--              <span>or select on 3d view below if tilemap available for your region</span>-->
<!--              <div class='streetview_container'>-->
<!--                <StreetView-->
<!--                  bind:elevation={property.altitude}-->
<!--                  bind:resolution={property.resolution}-->
<!--                  bind:lat={property.coord[0]}-->
<!--                  bind:lng={property.coord[1]}-->
<!--                />-->
<!--              </div>-->
						</div>
					{/if}
				</div>
				<button
					class='next_button'
					on:click|preventDefault={() => {
          if (modeLocationCount === 0) {
            handleNextLocation.LOC_ADDR()
          } else if (modeLocationCount === 1) {
            handleNextLocation.LOC_MAP()
          } else if (modeLocationCount === 2) {
            handleNextLocation.LOC_STREETVIEW()
          }
        }}>
					<span>NEXT</span>
				</button>
			</section>
			<section bind:this={cards[1]} class='subpage info' id='subpage_2'>
				<AddOtherFeesDialog
					bind:fee={otherFeeObj.fee}
					bind:name={otherFeeObj.name}
					bind:this={addOtherFeeDialog}
				>
					<button class='add_fee_btn' on:click={addOtherFee}>
						Add
					</button>
				</AddOtherFeesDialog>
				<button class='back_button' on:click={handleBackInfo}>
					<Icon className='iconBack' color='#475569' size={18} src={FaSolidAngleLeft}/>
				</button>
				<div class='subpage_content'>
					<h3>{ modeInfo }</h3>
					{#if modeInfo===INFO_FEAT}
						<div class='feature'>
							<div class='inputs'>
								<div class='row'>
									<div class='input_box'>
										<label for='houseType'>House type <span class='asterisk'>*</span></label>
										<select id='houseType' name='houseType' bind:value={infoObj.houseType}>
											{#each houseTypeLists as t}
												<option value={t}>{t}</option>
											{/each}
										</select>
									</div>
									<div class='input_box'>
										<label for='parking'>Parking <span class='asterisk'>*</span></label>
										<select id='parking' name='parking' bind:value={property.parking}>
											<option value='1'>Yes</option>
											<option value='0'>No</option>
										</select>
									</div>
								</div>
								<div class='room_area'>
									{#if property.houseType!=='land'}
										<div class='input_box beds'>
											<label for='beds' class="with_icon">
												<Icon className="labels_icon" color='#475569' size={16} src={FaSolidBed}/>
												<span>Beds</span>
											</label>
											<input id='beds' type='number' min='0' bind:value={property.bedroom}/>
										</div>
										<div class='input_box baths'>
											<label for='baths' class="with_icon">
												<Icon className="labels_icon" color='#475569' size={13} src={FaSolidBath}/>
												<span>Baths</span>
											</label>
											<input id='baths' type='number' min='0' bind:value={property.bathroom}/>
										</div>
										<div class='input_box livings'>
											<label for='livings' class="with_icon">
												<Icon className="labels_icon" color='#475569' size={13} src={FaSolidChair}/>
												<span>Livings</span>
											</label>
											<input id='livings' type='number' min='0' bind:value={property.livingroom}/>
										</div>
									{/if}
									<div class='input_box area'>
										<label for='area' class="with_icon">
											<Icon className="labels_icon" color='#475569' size={13} src={FaSolidBorderTopLeft}/>
											<span>{infoUnitMode} <span class='asterisk'>*</span></span>
											<button class='unit_toggle' on:click={handleInfoUnitMode.toggle}>
												<span class='bg'></span>
											</button>
										</label>
										<input id='area' type='number' min='0' bind:value={houseSize}/>
									</div>
								</div>
							</div>
						</div>
					{/if}
					{#if modeInfo===INFO_PRICE}
						<div class='price'>
							<div class='rent_or_sell'>
								<label class={property.purpose === 'sell' ? 'option clicked': 'option'} for='sell'>
									<input
										type='radio'
										name='rent_or_sell'
										on:click={() => (property.purpose = 'sell')}
										id='sell'
										value='sell'
									/>
									Sell
								</label>
								<label class={property.purpose === 'rent' ? 'option clicked': 'option'} for='rent'>
									<input
										type='radio'
										name='rent_or_sell'
										on:click={() => (property.purpose = 'rent')}
										id='rent'
										value='rent'
									/>
									Rent
								</label>
							</div>
							<div class='row'>
								<div class='input_box prop_price'>
									<label for='price'>{property.purpose==='sell' ? 'Property Price' : 'Rent'}</label>
									<input id='price' type='number' min='0' bind:value={property.lastPrice}/>
									<span>$</span>
								</div>
								{#if property.purpose==='rent'}
									<p class='permonth'>/month</p>
								{/if}
							</div>
							<div class='row'>
								<div class='input_box'>
									<label for='agency_fee'>Agency Fee</label>
									<select id='agency_fee' bind:value={infoObj.agencyFee}>
										<option value='true'>Yes</option>
										<option value='false'>No</option>
									</select>
								</div>
								{#if infoObj.agencyFee==='true'}
									<div class='input_box agency_fee'>
										<label for='agency_fee_percent'>Charge to Buyer</label>
										<input id='agency_fee_percent' type='number' min='0' max='99' bind:value={property.agencyFeePercent}/>
										<span>%</span>
									</div>
								{/if}
							</div>
							{#if property.purpose==='rent'}
								<div class='row'>
									<div class='input_box'>
										<label for='deposit'>Deposit Fee</label>
										<select id='deposit' bind:value={infoObj.deposit}>
											<option value='true'>Yes</option>
											<option value='false'>No</option>
										</select>
									</div>
									{#if infoObj.deposit==='true'}
										<div class='input_box deposit_fee'>
											<label for='deposit_fee'>Fee</label>
											<input id='deposit_fee' type='number' min='0' bind:value={property.depositFee}/>
											<span>$</span> <!-- TODO: Use current country currency sign -->
										</div>
									{/if}
								</div>
								<div class='row'>
									<div class='input_box min_duration'>
										<label for='minimum_duration'>Minimum Duration</label>
										<input id='minimum_duration' type='number' min='1' bind:value={property.minimumDurationYear}/>
										<span>Year</span>
									</div>
								</div>
								<div class='other_fee'>
									<header>
										<h4>Other Fee</h4>
										<button class='add_fee' on:click={addOtherFeeDialog.showModal()}>
											Add
										</button>
									</header>
									<div class='other_fee_lists'>
										{#if property.otherFees && property.otherFees.length}
											{#each property.otherFees as otherFee}
												<div class='fee'>
													<span>{otherFee.name}</span>
													<b>{formatPrice( otherFee.fee, countryCurrency )}/mo</b>
												</div>
											{/each}
										{:else}
											<div class='fee'>
												<span>Example Fee #1</span>
												<span>$$$</span>
											</div>
											<div class='fee'>
												<span>Example Fee #1</span>
												<span>$$$</span>
											</div>
										{/if}
									</div>
								</div>
							{/if}
						</div>
					{/if}
				</div>
				<button
					class='next_button'
					on:click|preventDefault={() => {
                     if (modeInfoCount === 0) {
                       handleNextInfo.INFO_FEAT();
                     } else if (modeInfoCount === 1) {
                       handleNextInfo.INFO_PRICE();
                     }
                  }}>
					<span>NEXT</span>
				</button>
			</section>
			<section bind:this={cards[2]} class='subpage picture' id='subpage_3'>
				<button class='back_button' on:click={backPage}>
					<Icon className='iconBack' color='#475569' size={18} src={FaSolidAngleLeft}/>
				</button>
				<div class='subpage_content'>
					<h3>Upload house photo</h3>
					<div class='upload_picture'>
						<div class='upload_container'>
							<label class='image_upload_button' for='upload_image'>
								{#if !houseImgUploading}
									<input
										bind:this={imageHouseInput}
										on:change={handlerHouseImage}
										type='file'
										accept='image/*'
										id='upload_image'
									/>
									<Icon size={35} className='upload_icon' color='#475569' src={FaSolidCamera}/>
									<p>Select file to Upload</p>
								{:else}
									<progress value={uploadHousePercent} max='100'></progress>
									<p>{uploadHouseStatus}</p>
								{/if}
							</label>
						</div>
						<div class='image_lists'>
							{#if property.images && property.images.length}
								{#each property.images as img, idx}
									<div class='image_card'>
										<div class='image_container'>
											<img alt='' src={img}/>
										</div>
										<div class='image_description'>
											{#if property.imageLabels && property.imageLabels.length}
												<input placeholder='Description' type='text' bind:value={property.imageLabels[idx]}/>
											{:else}
												<input placeholder='Description' type='text'/>
											{/if}
										</div>
										<button
											class='remove_image'
											title='remove this image'
											on:click|preventDefault={() => removeImage(idx)}
										>
											<Icon color='#FFF' size={12} src={FaClock}/>
										</button>
									</div>
								{/each}
							{/if}
						</div>
					</div>
				</div>
				<button class='next_button' on:click={nextPage}>
					<span>NEXT</span>
				</button>
			</section>
			<section bind:this={cards[3]} class='subpage preview' id='subpage_4'>
				{#if isPropertySubmitted===false}
					<button class='back_button' on:click={backPage}>
						<Icon className='iconBack' color='#475569' size={18} src={FaSolidAngleLeft}/>
					</button>
					<div class='subpage_content'>
						<div class='preview_content'>
							<h3>Preview your property</h3>
							<div class='image_properties'>
								{#if property.images && property.images.length}
									<div class='img_container'>
										<!-- TODO: click image to zoom -->
										<img alt='' src={property.images[0]}/>
									</div>
								{:else}
									<div class='img_container'>
										<div class='image_empty'>
											<Icon size={40} color='#475569' src={FaSolidImage}/>
											<span>No Image !</span>
										</div>
									</div>
								{/if}
							</div>
							<div class='preview_details'>
								<div class='main_details'>
									<span class={property.purpose === 'rent' ? `label_rent purpose` : `label_sale purpose`}>
										{property.purpose==='rent' ? `For ${property.purpose}` : `On Sale`}
									</span>
									<div class='price_house'>
										<div class='left'>
											<div class='price'>
												<h5>{formatPrice( property.lastPrice, countryCurrency )}</h5>
												{ #if property.purpose==='rent'}
													<span>/mo</span>
												{/if}
											</div>
											<span class='agency_fee'>
												Agency Fee: {property.agencyFeePercent}%
											</span>
										</div>
										<div class='right'>
											<div class='house_type'>
												<Icon color='#FFF' size={18} src={FaSolidHouse}/>
												<span>{property.houseType}</span>
											</div>
										</div>
									</div>
								</div>
								<div class='feature_details'>
									<div class='feature'>
										<b>{property.bedroom}</b>
										<div>
											<Icon color='#475569' size={16} src={FaSolidBed}/>
											<span>Beds</span>
										</div>
									</div>
									<div class='feature'>
										<b>{property.bathroom}</b>
										<div>
											<Icon color='#475569' size={13} src={FaSolidBath}/>
											<span>Baths</span>
										</div>
									</div>
									<div class='feature'>
										<b>{property.livingroom}</b>
										<div>
											<Icon color='#475569' size={13} src={FaSolidChair}/>
											<span>Livings</span>
										</div>
									</div>
									<div class='feature'>
										<b>{houseSize}</b>
										<div>
											<Icon color='#475569' size={13} src={FaSolidBorderTopLeft}/>
											<span>{infoUnitMode}</span>
											<button class='unit_toggle' on:click|preventDefault={handleInfoUnitMode.toggle}>
												<span class='bg'></span>
											</button>
										</div>
									</div>
								</div>
								<div class='other_details'>
									{#if property.purpose==='rent'}
										<div class='details'>
											<h5>Rent Detail</h5>
											<div class='item'>
												<span>Deposit Fee</span>
												<b>{formatPrice( property.depositFee, countryCurrency )}</b>
											</div>
											<div class='item'>
												<span>Minimum Duration</span>
												<b>{property.minimumDurationYear} Year</b>
											</div>
										</div>
										{#if infoObj.otherFee && infoObj.otherFee.length}
											<div class='details'>
												<h5>Other Fee</h5>
												{#each infoObj.otherFee as otherfee}
													<div class='item'>
														<span>{otherfee.name}</span>
														<b>{formatPrice( otherfee.fee, countryCurrency )}/mo</b>
													</div>
												{/each}
											</div>
										{/if}
									{/if}
									<div class='details'>
										<h5>Parking</h5>
										<div class='item'>
											<span>Parking</span>
											<b>{property.parking==='true' ? 'Yes' : 'No'}</b>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<button class='next_button' on:click|preventDefault={handleSubmit}>
						{#if submitLoading===false}
							<span>SUBMIT</span>
						{/if}
						{#if submitLoading===true}
							<Icon className='spin' color='#FFF' size={15} src={FaSolidCircleNotch}/>
						{/if}
					</button>
				{/if}
				{#if isPropertySubmitted===true}
					<button class='back_button' on:click={() => isPropertySubmitted = false}>
						<Icon className='iconBack' color='#475569' size={18} src={FaSolidAngleLeft}/>
					</button>
					<div class='property_submitted_container'>
						<div class='property_submitted'>
							<div class='icon_submitted'>
								<Icon size={110} color='#059669' src={FaCircleCheck}/>
							</div>
							<div class='message_submmitted'>
								<b>We will review it soon</b>
								<p>Thanks you for submitting your property.</p>
							</div>
						</div>
						<div class='actions'>
							<a class='new' href="/realtor/property">Create New one</a>
							<a class='see' href="/realtor/property/{res_propId}">Edit the property</a>
							<a class='see' href="/guest/property/{res_propId}" target='_blank'>See the property as guest</a>
							<a class='see' href="/user/property/{res_propId}" target='_blank'>See the property as logged in user</a>
						</div>
					</div>
				{/if}
			</section>
		</div>
	</div>
</div>

<style>
    /* General purpose selector */
    :global(.back_button:hover .iconBack) {
        fill : #EF4444;
    }

    @keyframes spin { /* TODO: use it for loading */
        from {
            transform : rotate(0deg);
        }
        to {
            transform : rotate(360deg);
        }
    }

    :global(.spin) {
        animation : spin 1s cubic-bezier(0, 0, 0.2, 1) infinite;
    }

    

    .realtor_subpage_container section .back_button {
        padding          : 8px;
        border           : none;
        background-color : rgb(0 0 0 / 0.06);
        border-radius    : 5px;
        font-size        : 14px;
        cursor           : pointer;
        display          : flex;
        flex-direction   : row;
        align-items      : center;
        gap              : 8px;
        position         : absolute;
        left             : 20px;
        top              : 20px;
    }

    .realtor_subpage_container section .back_button:hover {
        background-color : rgb(0 0 0 / 0.05);
        color            : #EF4444;
    }

    .realtor_subpage_container section .subpage_content h3 {
        margin     : 8px 0;
        text-align : center;
        font-size  : 20px;
    }

    .input_box {
        display        : flex;
        flex-direction : column;
        gap            : 8px;
        width          : 100%;
    }

    .input_box label {
        font-size   : 13px;
        font-weight : 700;
        margin-left : 10px;
    }

    .input_box input,
    .input_box select {
        width            : 100%;
        border           : 1px solid #CBD5E1;
        background-color : #F1F5F9;
        border-radius    : 8px;
        padding          : 12px;
    }

    .input_box input:focus,
    .input_box select:focus {
        border-color : #3B82F6;
        outline      : 1px solid #3B82F6;
    }

    /* =========================*/

    .realtor_step_progress_bar {
        position         : relative;
        margin-top       : -40px;
        margin-left      : auto;
        margin-right     : auto;
        display          : flex;
        justify-content  : center;
        background-color : #EF4444;
        padding-bottom   : 70px;
    }

    .realtor_step_progress_bar .container {
        width            : 940px;
        margin-left      : auto;
        margin-right     : auto;
        display          : flex;
        flex-direction   : row;
        justify-content  : center;
        align-items      : center;
        background-color : white;
        border-radius    : 10px;
        filter           : drop-shadow(0 10px 8px rgb(0 0 0 / 0.04)) drop-shadow(0 4px 3px rgb(0 0 0 / 0.1));
        padding          : 13px 5%;
    }

    .realtor_step_progress_bar .container .back_button {
        padding          : 8px;
        background-color : rgb(0 0 0 / 0.06);
        border-radius    : 5px;
        font-size        : 14px;
        cursor           : pointer;
        border           : none;
        text-decoration  : none;
        height           : fit-content;
        color            : #334155;
    }

    .realtor_step_progress_bar .container .back_button:hover {
        color : #EF4444;
    }

    .realtor_step_progress_bar .step_wrapper {
        width           : 500px;
        display         : flex;
        flex-direction  : row;
        justify-content : space-between;
        padding-top     : 5px;
    }

    .realtor_step_progress_bar .step_wrapper .step_item {
        position        : relative;
        display         : flex;
        flex-direction  : column;
        justify-content : center;
        align-items     : center;
        flex            : 1;
        font-size       : 12px;
        color           : #334155;
    }

    .realtor_step_progress_bar .step_wrapper .step_item::before {
        position      : absolute;
        content       : '';
        border-bottom : 2px solid #CBD5E1;
        width         : 100%;
        top           : 5px;
        left          : -50%;
        z-index       : 2;
    }

    .realtor_step_progress_bar .step_wrapper .step_item::after {
        position      : absolute;
        content       : '';
        border-bottom : 2px solid #CBD5E1;
        width         : 100%;
        top           : 5px;
        left          : 50%;
        z-index       : 2;
    }

    .realtor_step_progress_bar .step_wrapper .step_item:first-child::before {
        content : none;
    }

    .realtor_step_progress_bar .step_wrapper .step_item:last-child::after {
        content : none;
    }

    .realtor_step_progress_bar .step_wrapper .step_item button {
        width            : 13px;
        height           : 13px;
        background-color : #CBD5E1;
        border-radius    : 100%;
        border           : none;
        z-index          : 4;
        cursor           : pointer;
    }

    .realtor_step_progress_bar .step_wrapper .step_item button:hover {
        outline : 5px solid rgb(0 0 0 / 0.09);
    }

    .realtor_step_progress_bar .step_wrapper .step_item p {
        margin : 8px 0 0 0;
    }

    .realtor_step_progress_bar .step_wrapper .step_item.active button {
        width            : 11px;
        height           : 11px;
        background-color : white;
        outline          : 3px solid #F97316;
        cursor           : pointer;
    }

    .step_item.completed::after {
        position      : absolute !important;
        content       : '' !important;
        border-bottom : 2px solid #F97316 !important;
        width         : 100% !important;
        top           : 5px !important;
        left          : 50% !important;
        z-index       : 3 !important;
    }

    .step_item.completed button {
        background-color : #F97316 !important;
    }

    /* Main Container Subpage */
    .create_property_container {
        margin : -45px 20px 0 20px;
    }

    .realtor_subpage_container {
        color            : #475569;
        position         : relative;
        margin-left      : auto;
        margin-right     : auto;
        display          : flex;
        flex-direction   : row;
        gap              : 20px;
        border-radius    : 10px;
        width            : 940px;
        min-height       : 700px;
        overflow-x       : scroll;
        scroll-snap-type : x mandatory;
        filter           : drop-shadow(0 10px 8px rgb(0 0 0 / 0.04)) drop-shadow(0 4px 3px rgb(0 0 0 / 0.1));
    }

    .realtor_subpage_container::-webkit-scrollbar-thumb {
        background-color : #EF4444;
        border-radius    : 4px;
    }

    .realtor_subpage_container::-webkit-scrollbar {
        height : 0;
        width  : 10px;
    }

    .realtor_subpage_container::-webkit-scrollbar-track {
        background-color : transparent;
    }

    .realtor_subpage_container section {
        padding           : 20px;
        background-color  : white;
        border-radius     : 10px;
        min-height        : 700px;
        flex              : 0 0 940px;
        scroll-snap-align : start;
        position          : relative;
        display           : flex;
        gap               : 20px;
        flex-direction    : column;
        justify-content   : space-between;
    }

    /* +============| SUBPAGE LOCATION |===========+ */
    .realtor_subpage_container section.location .subpage_content {
        display        : flex;
        flex-direction : column;
        flex-grow      : 1;
    }

    .realtor_subpage_container section.location .subpage_content .address {
        margin-top     : 20px;
        display        : flex;
        flex-direction : column;
        gap            : 15px;
    }

    .realtor_subpage_container section.location .subpage_content .address .row {
        display               : grid;
        grid-template-columns : 1fr 1fr;
        gap                   : 20px;
    }

    .realtor_subpage_container section.location .location_map {
        height         : 100%;
        width          : 100%;
        display        : flex;
        flex-direction : column;
        gap            : 10px;
        margin-top     : 20px;
    }

    .realtor_subpage_container section.location .location_map #input_address {
        margin-top    : 10px;
        padding       : 12px 15px;
        border-radius : 2px;
        border        : none;
        width         : 400px;
        filter        : drop-shadow(0 10px 8px rgb(0 0 0 / 0.04)) drop-shadow(0 4px 3px rgb(0 0 0 / 0.1));
    }

    .realtor_subpage_container section.location .location_map #input_address:focus {
        border-color : #F97316;
        outline      : 2px solid #F97316;
    }

    .realtor_subpage_container section.location .location_map .address_country_info {
        display         : flex;
        flex-direction  : row;
        flex-wrap       : wrap;
        justify-content : space-between;
        gap             : 10px;
    }

    .realtor_subpage_container section.location .location_map .address_country_info .country,
    .realtor_subpage_container section.location .location_map .address_country_info .address {
        display        : flex;
        flex-direction : row;
        gap            : 10px;
        align-items    : center;
        margin         : 0 !important;
    }

    .realtor_subpage_container section.location .location_map .address_country_info p {
        margin    : 0;
        font-size : 15px;
    }

    .realtor_subpage_container section.location .location_map .map_container {
        border        : 1px solid #CBD5E1;
        display       : block;
        position      : relative;
        width         : 100%;
        height        : 100%;
        flex-grow     : 1;
        border-radius : 8px;
        overflow      : hidden;
    }

    .realtor_subpage_container section.location .location_streetview {
        display        : flex;
        flex-direction : column;
        gap            : 15px;
        flex-grow      : 1;
    }

    .realtor_subpage_container section.location .location_streetview .description {
        font-size   : 17px;
        text-align  : center;
        color       : #636C77;
        line-height : 1em;
        margin      : 0;
    }

    .realtor_subpage_container section.location .location_streetview span {
      font-weight: 600;
      width: 80%;
      margin: 0 auto;
      padding: 0 10px;
    }

    .streetview_container .input_box {
      margin-top: 15px !important;
    }

    .realtor_subpage_container section.location .location_streetview .streetview_container {
        flex-grow : 1;
        position  : relative;
        width     : 80%;
        margin    : auto;
    }

    /* +============| SUBPAGE INFO |===========+ */

    .realtor_subpage_container section.info .add_fee_btn {
        background-color : #F97316;
        color            : white;
        border-radius    : 8px;
        border           : none;
        padding          : 10px;
        cursor           : pointer;
        width            : 100%;
    }

    .realtor_subpage_container section.info .subpage_content .feature {
        margin-top : 50px;
    }

    .realtor_subpage_container section.info .subpage_content .feature .inputs {
        display        : flex;
        flex-direction : column;
        gap            : 30px;
        margin-top     : 20px;
    }

    .realtor_subpage_container section.info .subpage_content .feature .inputs .row {
        display               : grid;
        grid-template-columns : 1fr 1fr;
        gap                   : 20px;
    }

    .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area {
        display        : flex;
        flex-direction : row;
        gap            : 20px;
    }

    .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area .beds,
    .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area .baths,
    .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area .livings {
        flex-basis : 20%;
    }

    .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area .beds label,
    .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area .baths label,
    .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area .livings label,
    .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area .area label {
        display         : flex !important;
        flex-direction  : row !important;
        justify-content : left !important;
        align-items     : center !important;
        gap             : 8px !important;
    }

    .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area .area {
        flex-basis : 40%;
    }

    .realtor_subpage_container section .unit_toggle {
        border     : none;
        background : transparent;
        position   : relative;
        cursor     : pointer;
    }

    .realtor_subpage_container section .unit_toggle .bg {
        width            : 0;
        height           : 0;
        border-radius    : 50%;
        background-color : rgb(0 0 0 / 0.06);
        z-index          : 1;
        position         : absolute;
        top              : -4px;
        left             : 1px;
    }

    .realtor_subpage_container section .unit_toggle:hover .bg {
        width  : 24px;
        height : 24px;
    }

    .realtor_subpage_container section.info .subpage_content .price {
        margin-top     : 30px;
        display        : flex;
        flex-direction : column;
        gap            : 20px;
    }

    .realtor_subpage_container section.info .subpage_content .price .permonth {
        line-height : 1em;
        margin      : 20px 0 0;
        font-size   : 17px;
        font-weight : 500
    }

    .realtor_subpage_container section.info .subpage_content .price .rent_or_sell {
        width                 : 100%;
        display               : grid;
        grid-template-columns : 1fr 1fr;
        border-collapse       : collapse;
    }

    .realtor_subpage_container section.info .subpage_content .price .rent_or_sell .option {
        margin           : 0;
        padding          : 10px 12px;
        border           : 1px solid #CBD5E1;
        background-color : #F1F5F9;
        font-weight      : 500;
        text-align       : center;
        cursor           : pointer;
    }

    .realtor_subpage_container section.info .subpage_content .price .rent_or_sell .option:nth-child(1) {
        border-top-left-radius    : 8px;
        border-bottom-left-radius : 8px;
    }

    .realtor_subpage_container section.info .subpage_content .price .rent_or_sell .option:nth-child(2) {
        border-top-right-radius    : 8px;
        border-bottom-right-radius : 8px;
    }

    .realtor_subpage_container section.info .subpage_content .price .rent_or_sell .option:hover {
        border : 1px solid #F97316;
        color  : #F97316;
    }

    .realtor_subpage_container section.info .subpage_content .price .rent_or_sell .option.clicked {
        background-color : #F97316;
        color            : white;
        border           : none;
    }

    .realtor_subpage_container section.info .subpage_content .price .rent_or_sell .option input[type='radio'] {
        position       : absolute;
        opacity        : 0;
        pointer-events : none;
    }

    .realtor_subpage_container section.info .subpage_content .price .row {
        display               : grid;
        grid-template-columns : 1fr 1fr;
        gap                   : 20px;
        align-items           : center;
    }

    .realtor_subpage_container section.info .subpage_content .price .row .prop_price,
    .realtor_subpage_container section.info .subpage_content .price .row .agency_fee,
    .realtor_subpage_container section.info .subpage_content .price .row .deposit_fee,
    .realtor_subpage_container section.info .subpage_content .price .row .min_duration {
        position : relative;
    }

    .realtor_subpage_container section.info .subpage_content .price .row .agency_fee input {
        padding : 12px 25px 12px 12px;
    }

    .realtor_subpage_container section.info .subpage_content .price .row .agency_fee span {
        position  : absolute;
        right     : 10px;
        top       : 35px;
        font-size : 15px;
        color     : black;
    }

    .realtor_subpage_container section.info .subpage_content .price .row .prop_price input,
    .realtor_subpage_container section.info .subpage_content .price .row .deposit_fee input {
        padding : 12px 12px 12px 25px;
    }

    .realtor_subpage_container section.info .subpage_content .price .row .prop_price span,
    .realtor_subpage_container section.info .subpage_content .price .row .deposit_fee span {
        position  : absolute;
        left      : 10px;
        top       : 35px;
        font-size : 14px;
        color     : black;
    }

    .realtor_subpage_container section.info .subpage_content .price .row .min_duration input {
        padding : 12px 42px 12px 12px;
    }

    .realtor_subpage_container section.info .subpage_content .price .row .min_duration span {
        position  : absolute;
        right     : 10px;
        top       : 35px;
        font-size : 15px;
        color     : #F97316;
    }

    .realtor_subpage_container section.info .subpage_content .price .other_fee {
        display        : flex;
        flex-direction : column;
        gap            : 15px;
    }

    .realtor_subpage_container section.info .subpage_content .price .other_fee header {
        display         : flex;
        flex-direction  : row;
        justify-content : space-between;
        align-items     : center;
        margin-top      : 20px;
    }

    .realtor_subpage_container section.info .subpage_content .price .other_fee header h4 {
        margin    : 0;
        font-size : 18px;
    }

    .realtor_subpage_container section.info .subpage_content .price .other_fee header .add_fee {
        color            : #F97316;
        border           : none;
        padding          : 10px 15px;
        font-weight      : 600;
        font-size        : 15px;
        border-radius    : 8px;
        cursor           : pointer;
        background-color : transparent;
    }

    .realtor_subpage_container section.info .subpage_content .price .other_fee header .add_fee:hover {
        background-color : #F1F5F9;
    }

    .realtor_subpage_container section.info .subpage_content .price .other_fee .other_fee_lists {
        padding          : 15px;
        background-color : #F1F5F9;
        border-radius    : 8px;
        display          : flex;
        flex-direction   : column;
        min-height       : 200px;
    }

    .realtor_subpage_container section.info .subpage_content .price .other_fee .other_fee_lists .fee {
        display         : flex;
        flex-direction  : row;
        justify-content : space-between;
        padding         : 10px 0;
        border-bottom   : 1px solid #CBD5E1;
        font-size       : 15px;
        font-weight     : 500;
    }

    /* +============| SUBPAGE PICTURE |===========+ */

    .realtor_subpage_container section.picture .subpage_content .upload_picture {
        margin-top     : 30px;
        display        : flex;
        flex-direction : column;
        gap            : 20px;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container {
        width  : 100%;
        height : fit-content;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container .image_upload_button {
        display          : flex;
        flex-direction   : column;
        justify-content  : center;
        align-items      : center;
        border           : 1px solid #CBD5E1;
        background-color : #F1F5F9;
        border-radius    : 8px;
        gap              : 8px;
        width            : 100%;
        height           : 110px;
        cursor           : pointer;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container .image_upload_button:hover {
        border : 1px solid #F97316;
        color  : #F97316;
    }

    :global(.realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container .image_upload_button:hover .upload_icon) {
        fill : #F97316;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container .image_upload_button input {
        position       : absolute;
        opacity        : 0;
        pointer-events : none;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container .image_upload_button p {
        font-size : 16px;
        margin    : 0;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container .image_upload_button progress {
        appearance    : none;
        border-radius : 8px;
        height        : 13px;
        overflow      : hidden;
        margin-bottom : 8px;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container .image_upload_button progress::-webkit-progress-bar {
        background-color   : aliceblue;
        box-shadow         : -1px 1px 10px 0 rgba(0, 0, 0, 0.3) inset;
        -webkit-box-shadow : -1px 1px 10px 0 rgba(0, 0, 0, 0.3) inset;
        -moz-box-shadow    : -1px 1px 10px 0 rgba(0, 0, 0, 0.3) inset;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container .image_upload_button progress::-webkit-progress-value {
        background-color : #F97316;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .upload_container .image_upload_button progress::-moz-progress-bar {
        background-color : #F97316;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .image_lists {
        display               : grid;
        gap                   : 20px;
        grid-auto-columns     : 1fr 1fr;
        grid-auto-rows        : 1fr 1fr;
        grid-template-columns : 1fr 1fr;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .image_lists .image_card {
        display          : flex;
        position         : relative;
        flex-direction   : column;
        padding          : 15px;
        background-color : #F1F5F9;
        border-radius    : 10px;
        gap              : 15px;
        border           : 1px solid #CBD5E1;
        height           : fit-content;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .image_lists .image_card .image_container {
        width         : 100%;
        height        : 250px;
        overflow      : hidden;
        border-radius : 8px;
        border        : 1px solid #CBD5E1;
        cursor        : pointer;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .image_lists .image_card .image_container:hover img {
        transform : scale(1.20);
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .image_lists .image_card .image_container img {
        object-fit          : cover;
        width               : 100%;
        height              : 100%;
        transition-duration : 75ms;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .image_lists .image_card .image_description input {
        width            : 100%;
        border           : 1px solid #CBD5E1;
        background-color : #F1F5F9;
        border-radius    : 8px;
        padding          : 12px;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .image_lists .image_card .image_description input:focus {
        border-color : #3B82F6;
        outline      : 1px solid #3B82F6;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .image_lists .image_card .remove_image {
        position         : absolute;
        right            : 10px;
        top              : 10px;
        padding          : 8px;
        border-radius    : 50%;
        border           : none;
        background-color : #EF4444;
        cursor           : pointer;
    }

    .realtor_subpage_container section.picture .subpage_content .upload_picture .image_lists .image_card .remove_image:hover {
        background-color : #F85454;
    }

    /* +============| SUBPAGE PREVIEW |===========+ */

    .realtor_subpage_container section.preview .subpage_content {
        display        : flex;
        flex-direction : column;
        flex-grow      : 1;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content {
        display        : flex;
        flex-direction : column;
        gap            : 20px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .img_container {
        height        : 300px;
        width         : 100%;
        overflow      : hidden;
        border        : 1px solid #CBD5E1;
        border-radius : 8px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .img_container img {
        object-fit : cover;
        width      : 100%;
        height     : 100%;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .img_container .image_empty {
        border-radius    : 8px;
        object-fit       : cover;
        width            : 100%;
        height           : 100%;
        background-color : rgb(0 0 0 / 0.06);
        display          : flex;
        flex-direction   : column;
        gap              : 10px;
        font-size        : 18px;
        justify-content  : center;
        align-items      : center;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content h4 {
        margin     : 0;
        font-size  : 20px;
        text-align : center;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details {
        display        : flex;
        flex-direction : column;
        gap            : 20px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .main_details {
        display        : flex;
        flex-direction : column;
        gap            : 10px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .main_details .purpose {
        width   : fit-content;
        padding : 4px 10px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .main_details .price_house {
        display         : flex;
        flex-direction  : row;
        justify-content : space-between;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .main_details .price_house .left {
        display        : flex;
        flex-direction : column;
        gap            : 5px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .main_details .price_house .left .price {
        display        : flex;
        flex-direction : row;
        gap            : 5px;
        align-items    : center;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .main_details .price_house .left .price h5 {
        margin    : 0;
        font-size : 35px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .main_details .price_house .left .price span {
        font-size : 16px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .main_details .price_house .right {
        height : fit-content;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .main_details .price_house .right .house_type {
        background-color : #F97316;
        display          : flex;
        flex-direction   : row;
        gap              : 8px;
        padding          : 8px 22px;
        color            : #FFF;
        font-size        : 16px;
        font-weight      : 500;
        text-transform   : capitalize;
        border-radius    : 999px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .feature_details {
        display         : flex;
        flex-direction  : row;
        justify-content : space-evenly;
        align-items     : center;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .feature_details .feature {
        display         : flex;
        flex-direction  : column;
        justify-content : center;
        align-items     : center;
        gap             : 5px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .feature_details .feature div {
        display        : flex;
        flex-direction : row;
        gap            : 5px;
        align-items    : center;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .feature_details .feature b {
        font-size : 35px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .other_details {
        display        : flex;
        flex-direction : column;
        gap            : 15px;
        width          : 60%;
        margin         : 20 auto 0;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .other_details .details {
        display        : flex;
        flex-direction : column;
        gap            : 10px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .other_details .details h5 {
        margin    : 0;
        font-size : 22px;
    }

    .realtor_subpage_container section.preview .subpage_content .preview_content .preview_details .other_details .details .item {
        display         : flex;
        flex-direction  : row;
        justify-content : space-between;
        font-weight     : 500;
        padding-bottom  : 7px;
        border-bottom   : 1px solid #CBD5E1;
    }

    .preview .property_submitted_container {
        display        : flex;
        flex-direction : column;
        gap            : 30px;
        height         : 100%;
    }

    .preview .property_submitted_container .property_submitted {
        height          : 100%;
        width           : 100%;
        display         : flex;
        flex-direction  : column;
        justify-content : center;
        align-items     : center;
        text-align      : center;
        gap             : 20px;
        flex-grow       : 1;
    }

    .preview .property_submitted .message_submmitted b {
        font-weight : 700;
        font-size   : 20px;
    }

    .preview .property_submitted_container .actions {
        display        : flex;
        flex-direction : column;
        gap            : 15px;
        height         : fit-content;
    }

    .preview .property_submitted_container .actions a {
        border-radius : 8px;
        border        : none;
        padding       : 10px;
        cursor        : pointer;
        width         : 100%;
        font-weight   : 600;
        text-decoration: none;
        text-align: center;
        color: #475569;
    }

    .preview .property_submitted_container .actions a.new {
        background-color : #F97316;
        color            : white;
        display          : flex;
        justify-content  : center;
    }

    .preview .property_submitted_container .actions a.new:hover {
        background-color : #F58433;
    }

    .preview .property_submitted_container .actions a.see {
        margin-right     : 10px;
        border           : 1px solid #CBD5E1;
        background-color : #F1F5F9;
    }

    .preview .property_submitted_container .actions a.see:hover {
        border : 1px solid #F97316;
        color  : #F97316;
    }

    /* Responsive to mobile device */
    @media (max-width : 768px) {
        .realtor_step_progress_bar {
            margin-top     : -50px;
            padding-left   : 20px;
            padding-right  : 20px;
            padding-bottom : 70px;
        }

        .realtor_step_progress_bar .container {
            width        : 100%;
            margin-left  : 20px;
            margin-right : 20px;
            padding      : 13px 5%;
        }

        .create_property_container {
            margin : -55px 20px 0 20px;
        }

        .realtor_subpage_container {
            margin-top   : -40px;
            margin-left  : auto;
            margin-right : auto;
            width        : 100%;
            min-height   : 400px;
        }

        .realtor_subpage_container section {
            padding           : 15px;
            background-color  : white;
            border-radius     : 10px;
            min-height        : 400px;
            flex              : 0 0 100%;
            scroll-snap-align : start;
            position          : relative;
            display           : flex;
            gap               : 15px;
            flex-direction    : column;
            justify-content   : space-between;
        }

        .realtor_subpage_container section.location .subpage_content .address .row {
            display               : flex;
            flex-direction: column;
            gap                   : 20px;
          }
        
          :global(.labels_icon) {
            width  : 10px;
            height : 10px;
          }

        .input_box .with_icon {
          font-size: 11px;
        }

        .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area {
          gap            : 10px;
        }

        .realtor_subpage_container section.info .subpage_content .feature .inputs .room_area .input_box {
          justify-content: space-between !important;
        }
    }
</style>